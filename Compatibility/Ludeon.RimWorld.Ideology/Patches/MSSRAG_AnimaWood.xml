<?xml version="1.0" encoding="utf-8"?>

<Patch>
    <!-- Anima Tree Wood -->
    <Operation Class="PatchOperationAdd">
        <xpath>/Defs/ThingDef[defName="Plant_TreeAnima"]/plant</xpath>
        <value>
            <harvestedThingDef>MSSRAG_AnimaLog</harvestedThingDef>
        </value>
    </Operation>
    <Operation Class="PatchOperationRemove">
        <xpath>/Defs/ThingDef[defName="Plant_TreeAnima"]/comps/li[@Class = "CompProperties_Glower"]</xpath>
    </Operation>

    <!-- Sap if Medieval Overhaul is active -->
    <Operation Class="PatchOperationFindMod">
        <mods>
            <li>Medieval Overhaul</li>
        </mods>
        <match Class="PatchOperationSequence">
            <li Class="PatchOperationReplace">
                <xpath>/Defs/ThingDef[defName="Plant_TreeAnima"]/thingClass</xpath>
                <value>
                    <thingClass>MedievalOverhaul.Plant_SecondaryDrop</thingClass>
                </value>
            </li>
            <li Class="PatchOperationAddModExtension">
                <xpath>/Defs/ThingDef[defName="Plant_TreeAnima"]/modExtensions</xpath>
                <value>
                    <li Class="MedievalOverhaul.SecondaryPlantDropExtension">
                        <secondaryDrop>MSSRAG_AnimaSap</secondaryDrop>
                        <secondaryDropAmountRange>20</secondaryDropAmountRange>
                        <secondaryDropChance>1</secondaryDropChance>
                        <secondaryNotWhenLeafless>false</secondaryNotWhenLeafless>
                    </li>
                </value>
            </li>
        </match>
    </Operation>
</Patch>
